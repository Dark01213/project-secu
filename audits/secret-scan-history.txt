92155b29917a55e15c4fc8610c61a79085c65ba6:localhost.pem
1:-----BEGIN CERTIFICATE-----
92155b29917a55e15c4fc8610c61a79085c65ba6:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
92155b29917a55e15c4fc8610c61a79085c65ba6:README.md
93:# remplir les variables requises (MONGODB_URI, JWT_SECRET, etc.)
269:- Si vous partagez des captures contenant des fichiers `.env` ou logs, remplacez les valeurs sensibles par `REDACTED` (ex: `JWT_SECRET=REDACTED`).
276:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
92155b29917a55e15c4fc8610c61a79085c65ba6:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
92155b29917a55e15c4fc8610c61a79085c65ba6:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
92155b29917a55e15c4fc8610c61a79085c65ba6:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
92155b29917a55e15c4fc8610c61a79085c65ba6:pages/api/auth/register.js
80:    const JWT_SECRET = process.env.JWT_SECRET
81:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
82:      console.error('JWT_SECRET not set in production')
85:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
92155b29917a55e15c4fc8610c61a79085c65ba6:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
92155b29917a55e15c4fc8610c61a79085c65ba6:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
92155b29917a55e15c4fc8610c61a79085c65ba6:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
92155b29917a55e15c4fc8610c61a79085c65ba6:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
92155b29917a55e15c4fc8610c61a79085c65ba6:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
92155b29917a55e15c4fc8610c61a79085c65ba6:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
870eb760b099660a6c714f90db107454caa14508:localhost.pem
1:-----BEGIN CERTIFICATE-----
870eb760b099660a6c714f90db107454caa14508:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
870eb760b099660a6c714f90db107454caa14508:README.md
93:# remplir les variables requises (MONGODB_URI, JWT_SECRET, etc.)
269:- Si vous partagez des captures contenant des fichiers `.env` ou logs, remplacez les valeurs sensibles par `REDACTED` (ex: `JWT_SECRET=REDACTED`).
276:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
870eb760b099660a6c714f90db107454caa14508:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
870eb760b099660a6c714f90db107454caa14508:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
870eb760b099660a6c714f90db107454caa14508:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
870eb760b099660a6c714f90db107454caa14508:pages/api/auth/register.js
80:    const JWT_SECRET = process.env.JWT_SECRET
81:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
82:      console.error('JWT_SECRET not set in production')
85:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
870eb760b099660a6c714f90db107454caa14508:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
870eb760b099660a6c714f90db107454caa14508:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
870eb760b099660a6c714f90db107454caa14508:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
870eb760b099660a6c714f90db107454caa14508:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
870eb760b099660a6c714f90db107454caa14508:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
870eb760b099660a6c714f90db107454caa14508:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
aa4a8f74656c62dea8bf28a1e043711ff5f4363c:localhost.pem
1:-----BEGIN CERTIFICATE-----
aa4a8f74656c62dea8bf28a1e043711ff5f4363c:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
aa4a8f74656c62dea8bf28a1e043711ff5f4363c:.env.production
5:# JWT_SECRET=REDACTED
aa4a8f74656c62dea8bf28a1e043711ff5f4363c:README.md
93:# remplir les variables requises (MONGODB_URI, JWT_SECRET, etc.)
269:- Si vous partagez des captures contenant des fichiers `.env` ou logs, remplacez les valeurs sensibles par `REDACTED` (ex: `JWT_SECRET=REDACTED`).
276:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
aa4a8f74656c62dea8bf28a1e043711ff5f4363c:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
aa4a8f74656c62dea8bf28a1e043711ff5f4363c:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
aa4a8f74656c62dea8bf28a1e043711ff5f4363c:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
aa4a8f74656c62dea8bf28a1e043711ff5f4363c:pages/api/auth/register.js
80:    const JWT_SECRET = process.env.JWT_SECRET
81:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
82:      console.error('JWT_SECRET not set in production')
85:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
aa4a8f74656c62dea8bf28a1e043711ff5f4363c:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
aa4a8f74656c62dea8bf28a1e043711ff5f4363c:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
aa4a8f74656c62dea8bf28a1e043711ff5f4363c:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
aa4a8f74656c62dea8bf28a1e043711ff5f4363c:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
aa4a8f74656c62dea8bf28a1e043711ff5f4363c:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
aa4a8f74656c62dea8bf28a1e043711ff5f4363c:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
7a04f155c97a2f9ca51e404f2c475825f229835b:localhost.pem
1:-----BEGIN CERTIFICATE-----
7a04f155c97a2f9ca51e404f2c475825f229835b:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
7a04f155c97a2f9ca51e404f2c475825f229835b:.env.production
5:# JWT_SECRET=REDACTED
7a04f155c97a2f9ca51e404f2c475825f229835b:README.md
93:# remplir les variables requises (MONGODB_URI, JWT_SECRET, etc.)
269:- Si vous partagez des captures contenant des fichiers `.env` ou logs, remplacez les valeurs sensibles par `REDACTED` (ex: `JWT_SECRET=REDACTED`).
276:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
7a04f155c97a2f9ca51e404f2c475825f229835b:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
7a04f155c97a2f9ca51e404f2c475825f229835b:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
7a04f155c97a2f9ca51e404f2c475825f229835b:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
7a04f155c97a2f9ca51e404f2c475825f229835b:pages/api/auth/register.js
80:    const JWT_SECRET = process.env.JWT_SECRET
81:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
82:      console.error('JWT_SECRET not set in production')
85:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
7a04f155c97a2f9ca51e404f2c475825f229835b:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
7a04f155c97a2f9ca51e404f2c475825f229835b:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
7a04f155c97a2f9ca51e404f2c475825f229835b:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
7a04f155c97a2f9ca51e404f2c475825f229835b:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
7a04f155c97a2f9ca51e404f2c475825f229835b:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
7a04f155c97a2f9ca51e404f2c475825f229835b:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
84de39a483adbaf7bf725c3a8346c216b51e251f:localhost.pem
1:-----BEGIN CERTIFICATE-----
84de39a483adbaf7bf725c3a8346c216b51e251f:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
84de39a483adbaf7bf725c3a8346c216b51e251f:.env.production
5:# JWT_SECRET=REDACTED
84de39a483adbaf7bf725c3a8346c216b51e251f:README.md
93:# remplir les variables requises (MONGODB_URI, JWT_SECRET, etc.)
269:- Si vous partagez des captures contenant des fichiers `.env` ou logs, remplacez les valeurs sensibles par `REDACTED` (ex: `JWT_SECRET=REDACTED`).
276:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
84de39a483adbaf7bf725c3a8346c216b51e251f:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
84de39a483adbaf7bf725c3a8346c216b51e251f:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
84de39a483adbaf7bf725c3a8346c216b51e251f:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
84de39a483adbaf7bf725c3a8346c216b51e251f:pages/api/auth/register.js
80:    const JWT_SECRET = process.env.JWT_SECRET
81:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
82:      console.error('JWT_SECRET not set in production')
85:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
84de39a483adbaf7bf725c3a8346c216b51e251f:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
84de39a483adbaf7bf725c3a8346c216b51e251f:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
84de39a483adbaf7bf725c3a8346c216b51e251f:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
84de39a483adbaf7bf725c3a8346c216b51e251f:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
84de39a483adbaf7bf725c3a8346c216b51e251f:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
84de39a483adbaf7bf725c3a8346c216b51e251f:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
6fbfa05e45fbfbf71a6352e829ca9e44c7659a42:localhost.pem
1:-----BEGIN CERTIFICATE-----
6fbfa05e45fbfbf71a6352e829ca9e44c7659a42:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
6fbfa05e45fbfbf71a6352e829ca9e44c7659a42:.env.production
5:# JWT_SECRET=REDACTED
6fbfa05e45fbfbf71a6352e829ca9e44c7659a42:README.md
93:# remplir les variables requises (MONGODB_URI, JWT_SECRET, etc.)
202:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
6fbfa05e45fbfbf71a6352e829ca9e44c7659a42:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
6fbfa05e45fbfbf71a6352e829ca9e44c7659a42:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
6fbfa05e45fbfbf71a6352e829ca9e44c7659a42:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
6fbfa05e45fbfbf71a6352e829ca9e44c7659a42:pages/api/auth/register.js
80:    const JWT_SECRET = process.env.JWT_SECRET
81:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
82:      console.error('JWT_SECRET not set in production')
85:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
6fbfa05e45fbfbf71a6352e829ca9e44c7659a42:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
6fbfa05e45fbfbf71a6352e829ca9e44c7659a42:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
6fbfa05e45fbfbf71a6352e829ca9e44c7659a42:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
6fbfa05e45fbfbf71a6352e829ca9e44c7659a42:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
6fbfa05e45fbfbf71a6352e829ca9e44c7659a42:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
6fbfa05e45fbfbf71a6352e829ca9e44c7659a42:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
1d009cb45072d262605094b6bcf100edbb482ef5:localhost.pem
1:-----BEGIN CERTIFICATE-----
1d009cb45072d262605094b6bcf100edbb482ef5:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
1d009cb45072d262605094b6bcf100edbb482ef5:.env.production
5:# JWT_SECRET=REDACTED
1d009cb45072d262605094b6bcf100edbb482ef5:README.md
93:# remplir les variables requises (MONGODB_URI, JWT_SECRET, etc.)
202:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
1d009cb45072d262605094b6bcf100edbb482ef5:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
1d009cb45072d262605094b6bcf100edbb482ef5:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
1d009cb45072d262605094b6bcf100edbb482ef5:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
1d009cb45072d262605094b6bcf100edbb482ef5:pages/api/auth/register.js
64:    const JWT_SECRET = process.env.JWT_SECRET
65:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
66:      console.error('JWT_SECRET not set in production')
69:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
1d009cb45072d262605094b6bcf100edbb482ef5:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
1d009cb45072d262605094b6bcf100edbb482ef5:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
1d009cb45072d262605094b6bcf100edbb482ef5:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
1d009cb45072d262605094b6bcf100edbb482ef5:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
1d009cb45072d262605094b6bcf100edbb482ef5:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
1d009cb45072d262605094b6bcf100edbb482ef5:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
0f6461d7085f3ec9c5e2c091162a48005012bf8b:localhost.pem
1:-----BEGIN CERTIFICATE-----
0f6461d7085f3ec9c5e2c091162a48005012bf8b:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
0f6461d7085f3ec9c5e2c091162a48005012bf8b:.env.production
5:# JWT_SECRET=REDACTED
0f6461d7085f3ec9c5e2c091162a48005012bf8b:README.md
93:# remplir les variables requises (MONGODB_URI, JWT_SECRET, etc.)
202:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
0f6461d7085f3ec9c5e2c091162a48005012bf8b:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
0f6461d7085f3ec9c5e2c091162a48005012bf8b:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
0f6461d7085f3ec9c5e2c091162a48005012bf8b:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
0f6461d7085f3ec9c5e2c091162a48005012bf8b:pages/api/auth/register.js
64:    const JWT_SECRET = process.env.JWT_SECRET
65:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
66:      console.error('JWT_SECRET not set in production')
69:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
0f6461d7085f3ec9c5e2c091162a48005012bf8b:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
0f6461d7085f3ec9c5e2c091162a48005012bf8b:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
0f6461d7085f3ec9c5e2c091162a48005012bf8b:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
0f6461d7085f3ec9c5e2c091162a48005012bf8b:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
0f6461d7085f3ec9c5e2c091162a48005012bf8b:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
0f6461d7085f3ec9c5e2c091162a48005012bf8b:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
673b4a038e896f905aaa57e74947e3ef271d691d:localhost.pem
1:-----BEGIN CERTIFICATE-----
673b4a038e896f905aaa57e74947e3ef271d691d:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
673b4a038e896f905aaa57e74947e3ef271d691d:.env.production
5:# JWT_SECRET=REDACTED
673b4a038e896f905aaa57e74947e3ef271d691d:README.md
93:# remplir les variables requises (MONGODB_URI, JWT_SECRET, etc.)
202:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
673b4a038e896f905aaa57e74947e3ef271d691d:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
673b4a038e896f905aaa57e74947e3ef271d691d:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
673b4a038e896f905aaa57e74947e3ef271d691d:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
673b4a038e896f905aaa57e74947e3ef271d691d:pages/api/auth/register.js
64:    const JWT_SECRET = process.env.JWT_SECRET
65:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
66:      console.error('JWT_SECRET not set in production')
69:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
673b4a038e896f905aaa57e74947e3ef271d691d:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
673b4a038e896f905aaa57e74947e3ef271d691d:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
673b4a038e896f905aaa57e74947e3ef271d691d:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
673b4a038e896f905aaa57e74947e3ef271d691d:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
673b4a038e896f905aaa57e74947e3ef271d691d:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
673b4a038e896f905aaa57e74947e3ef271d691d:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
6394c07864c3af5d0e2fcbc6cc7a2f4e8b5ed0cf:localhost.pem
1:-----BEGIN CERTIFICATE-----
6394c07864c3af5d0e2fcbc6cc7a2f4e8b5ed0cf:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
6394c07864c3af5d0e2fcbc6cc7a2f4e8b5ed0cf:.env.production
5:# JWT_SECRET=REDACTED
6394c07864c3af5d0e2fcbc6cc7a2f4e8b5ed0cf:README.md
93:# remplir les variables requises (MONGODB_URI, JWT_SECRET, etc.)
202:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
6394c07864c3af5d0e2fcbc6cc7a2f4e8b5ed0cf:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
6394c07864c3af5d0e2fcbc6cc7a2f4e8b5ed0cf:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
6394c07864c3af5d0e2fcbc6cc7a2f4e8b5ed0cf:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
6394c07864c3af5d0e2fcbc6cc7a2f4e8b5ed0cf:pages/api/auth/register.js
64:    const JWT_SECRET = process.env.JWT_SECRET
65:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
66:      console.error('JWT_SECRET not set in production')
69:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
6394c07864c3af5d0e2fcbc6cc7a2f4e8b5ed0cf:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
6394c07864c3af5d0e2fcbc6cc7a2f4e8b5ed0cf:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
6394c07864c3af5d0e2fcbc6cc7a2f4e8b5ed0cf:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
6394c07864c3af5d0e2fcbc6cc7a2f4e8b5ed0cf:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
6394c07864c3af5d0e2fcbc6cc7a2f4e8b5ed0cf:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
6394c07864c3af5d0e2fcbc6cc7a2f4e8b5ed0cf:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
8e7db833b92bdeb277c58a20041c6b4627926bd7:localhost.pem
1:-----BEGIN CERTIFICATE-----
8e7db833b92bdeb277c58a20041c6b4627926bd7:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
8e7db833b92bdeb277c58a20041c6b4627926bd7:README.md
93:# remplir les variables requises (MONGODB_URI, JWT_SECRET, etc.)
202:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
8e7db833b92bdeb277c58a20041c6b4627926bd7:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
8e7db833b92bdeb277c58a20041c6b4627926bd7:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
8e7db833b92bdeb277c58a20041c6b4627926bd7:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
8e7db833b92bdeb277c58a20041c6b4627926bd7:pages/api/auth/register.js
64:    const JWT_SECRET = process.env.JWT_SECRET
65:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
66:      console.error('JWT_SECRET not set in production')
69:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
8e7db833b92bdeb277c58a20041c6b4627926bd7:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
8e7db833b92bdeb277c58a20041c6b4627926bd7:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
8e7db833b92bdeb277c58a20041c6b4627926bd7:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
8e7db833b92bdeb277c58a20041c6b4627926bd7:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
8e7db833b92bdeb277c58a20041c6b4627926bd7:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
8e7db833b92bdeb277c58a20041c6b4627926bd7:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
ea8311bf2e37a419f7aeb8aa0e9da758d6071c77:localhost.pem
1:-----BEGIN CERTIFICATE-----
ea8311bf2e37a419f7aeb8aa0e9da758d6071c77:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
ea8311bf2e37a419f7aeb8aa0e9da758d6071c77:README.md
93:# remplir les variables requises (MONGODB_URI, JWT_SECRET, etc.)
202:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
ea8311bf2e37a419f7aeb8aa0e9da758d6071c77:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
ea8311bf2e37a419f7aeb8aa0e9da758d6071c77:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
ea8311bf2e37a419f7aeb8aa0e9da758d6071c77:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
ea8311bf2e37a419f7aeb8aa0e9da758d6071c77:pages/api/auth/register.js
64:    const JWT_SECRET = process.env.JWT_SECRET
65:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
66:      console.error('JWT_SECRET not set in production')
69:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
ea8311bf2e37a419f7aeb8aa0e9da758d6071c77:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
ea8311bf2e37a419f7aeb8aa0e9da758d6071c77:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
ea8311bf2e37a419f7aeb8aa0e9da758d6071c77:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
ea8311bf2e37a419f7aeb8aa0e9da758d6071c77:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
ea8311bf2e37a419f7aeb8aa0e9da758d6071c77:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
ea8311bf2e37a419f7aeb8aa0e9da758d6071c77:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
e1ab97cc16e7a4719499c26f32b22a8544debefe:localhost.pem
1:-----BEGIN CERTIFICATE-----
e1ab97cc16e7a4719499c26f32b22a8544debefe:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
e1ab97cc16e7a4719499c26f32b22a8544debefe:README.md
7:1. Copy `.env.example` to `.env` and fill values (`MONGODB_URI`, `JWT_SECRET`).
54:- `JWT_SECRET` : secret JWT fort (NE JAMAIS LE COMMITER)
162:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
e1ab97cc16e7a4719499c26f32b22a8544debefe:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
e1ab97cc16e7a4719499c26f32b22a8544debefe:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
e1ab97cc16e7a4719499c26f32b22a8544debefe:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
e1ab97cc16e7a4719499c26f32b22a8544debefe:pages/api/auth/register.js
64:    const JWT_SECRET = process.env.JWT_SECRET
65:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
66:      console.error('JWT_SECRET not set in production')
69:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
e1ab97cc16e7a4719499c26f32b22a8544debefe:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
e1ab97cc16e7a4719499c26f32b22a8544debefe:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
e1ab97cc16e7a4719499c26f32b22a8544debefe:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
e1ab97cc16e7a4719499c26f32b22a8544debefe:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
e1ab97cc16e7a4719499c26f32b22a8544debefe:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
e1ab97cc16e7a4719499c26f32b22a8544debefe:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
ca386c52ec7482e7dade72c7087bf62f9eb806e2:localhost.pem
1:-----BEGIN CERTIFICATE-----
ca386c52ec7482e7dade72c7087bf62f9eb806e2:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
ca386c52ec7482e7dade72c7087bf62f9eb806e2:README.md
7:1. Copy `.env.example` to `.env` and fill values (`MONGODB_URI`, `JWT_SECRET`).
54:- `JWT_SECRET` : secret JWT fort (NE JAMAIS LE COMMITER)
162:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
ca386c52ec7482e7dade72c7087bf62f9eb806e2:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
ca386c52ec7482e7dade72c7087bf62f9eb806e2:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
ca386c52ec7482e7dade72c7087bf62f9eb806e2:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
ca386c52ec7482e7dade72c7087bf62f9eb806e2:pages/api/auth/register.js
64:    const JWT_SECRET = process.env.JWT_SECRET
65:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
66:      console.error('JWT_SECRET not set in production')
69:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
ca386c52ec7482e7dade72c7087bf62f9eb806e2:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
ca386c52ec7482e7dade72c7087bf62f9eb806e2:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
ca386c52ec7482e7dade72c7087bf62f9eb806e2:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
ca386c52ec7482e7dade72c7087bf62f9eb806e2:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
ca386c52ec7482e7dade72c7087bf62f9eb806e2:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
ca386c52ec7482e7dade72c7087bf62f9eb806e2:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
9dabf23fd77577efd5a168c034ee683388f83a63:localhost.pem
1:-----BEGIN CERTIFICATE-----
9dabf23fd77577efd5a168c034ee683388f83a63:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
9dabf23fd77577efd5a168c034ee683388f83a63:README.md
7:1. Copy `.env.example` to `.env` and fill values (`MONGODB_URI`, `JWT_SECRET`).
54:- `JWT_SECRET` : secret JWT fort (NE JAMAIS LE COMMITER)
162:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
9dabf23fd77577efd5a168c034ee683388f83a63:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
9dabf23fd77577efd5a168c034ee683388f83a63:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
9dabf23fd77577efd5a168c034ee683388f83a63:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
9dabf23fd77577efd5a168c034ee683388f83a63:pages/api/auth/register.js
64:    const JWT_SECRET = process.env.JWT_SECRET
65:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
66:      console.error('JWT_SECRET not set in production')
69:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
9dabf23fd77577efd5a168c034ee683388f83a63:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
9dabf23fd77577efd5a168c034ee683388f83a63:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
9dabf23fd77577efd5a168c034ee683388f83a63:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
9dabf23fd77577efd5a168c034ee683388f83a63:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
9dabf23fd77577efd5a168c034ee683388f83a63:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
9dabf23fd77577efd5a168c034ee683388f83a63:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
b4cb902974a966fbc30ea0769dc34bb1bc079583:localhost.pem
1:-----BEGIN CERTIFICATE-----
b4cb902974a966fbc30ea0769dc34bb1bc079583:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
b4cb902974a966fbc30ea0769dc34bb1bc079583:README.md
7:1. Copy `.env.example` to `.env` and fill values (`MONGODB_URI`, `JWT_SECRET`).
54:- `JWT_SECRET` : secret JWT fort (NE JAMAIS LE COMMITER)
162:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
b4cb902974a966fbc30ea0769dc34bb1bc079583:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
b4cb902974a966fbc30ea0769dc34bb1bc079583:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
b4cb902974a966fbc30ea0769dc34bb1bc079583:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
b4cb902974a966fbc30ea0769dc34bb1bc079583:pages/api/auth/register.js
64:    const JWT_SECRET = process.env.JWT_SECRET
65:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
66:      console.error('JWT_SECRET not set in production')
69:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
b4cb902974a966fbc30ea0769dc34bb1bc079583:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
b4cb902974a966fbc30ea0769dc34bb1bc079583:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
b4cb902974a966fbc30ea0769dc34bb1bc079583:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
b4cb902974a966fbc30ea0769dc34bb1bc079583:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
b4cb902974a966fbc30ea0769dc34bb1bc079583:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
b4cb902974a966fbc30ea0769dc34bb1bc079583:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
31f9b850128c4494e9ad1c68601ee3b299b134cd:localhost.pem
1:-----BEGIN CERTIFICATE-----
31f9b850128c4494e9ad1c68601ee3b299b134cd:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
31f9b850128c4494e9ad1c68601ee3b299b134cd:README.md
7:1. Copy `.env.example` to `.env` and fill values (`MONGODB_URI`, `JWT_SECRET`).
54:- `JWT_SECRET` : secret JWT fort (NE JAMAIS LE COMMITER)
162:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
31f9b850128c4494e9ad1c68601ee3b299b134cd:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
31f9b850128c4494e9ad1c68601ee3b299b134cd:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
31f9b850128c4494e9ad1c68601ee3b299b134cd:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
31f9b850128c4494e9ad1c68601ee3b299b134cd:pages/api/auth/register.js
64:    const JWT_SECRET = process.env.JWT_SECRET
65:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
66:      console.error('JWT_SECRET not set in production')
69:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
31f9b850128c4494e9ad1c68601ee3b299b134cd:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
31f9b850128c4494e9ad1c68601ee3b299b134cd:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
31f9b850128c4494e9ad1c68601ee3b299b134cd:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
31f9b850128c4494e9ad1c68601ee3b299b134cd:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
31f9b850128c4494e9ad1c68601ee3b299b134cd:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
31f9b850128c4494e9ad1c68601ee3b299b134cd:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
a1adedb7bdf7afce079a8470edb73bcfed2c4c28:localhost-key.pem
1:-----BEGIN PRIVATE KEY-----
a1adedb7bdf7afce079a8470edb73bcfed2c4c28:localhost.pem
1:-----BEGIN CERTIFICATE-----
a1adedb7bdf7afce079a8470edb73bcfed2c4c28:localhost-key.pem
1:-----BEGIN PRIVATE KEY-----
28:-----END PRIVATE KEY-----
a1adedb7bdf7afce079a8470edb73bcfed2c4c28:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
a1adedb7bdf7afce079a8470edb73bcfed2c4c28:README.md
7:1. Copy `.env.example` to `.env` and fill values (`MONGODB_URI`, `JWT_SECRET`).
54:- `JWT_SECRET` : secret JWT fort (NE JAMAIS LE COMMITER)
162:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
a1adedb7bdf7afce079a8470edb73bcfed2c4c28:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
a1adedb7bdf7afce079a8470edb73bcfed2c4c28:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
a1adedb7bdf7afce079a8470edb73bcfed2c4c28:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
a1adedb7bdf7afce079a8470edb73bcfed2c4c28:pages/api/auth/register.js
64:    const JWT_SECRET = process.env.JWT_SECRET
65:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
66:      console.error('JWT_SECRET not set in production')
69:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
a1adedb7bdf7afce079a8470edb73bcfed2c4c28:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
a1adedb7bdf7afce079a8470edb73bcfed2c4c28:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
a1adedb7bdf7afce079a8470edb73bcfed2c4c28:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
a1adedb7bdf7afce079a8470edb73bcfed2c4c28:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
a1adedb7bdf7afce079a8470edb73bcfed2c4c28:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
a1adedb7bdf7afce079a8470edb73bcfed2c4c28:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
8a7c124b7191a79abed16bc14a22f99923b700fa:localhost-key.pem
1:-----BEGIN PRIVATE KEY-----
8a7c124b7191a79abed16bc14a22f99923b700fa:localhost.pem
1:-----BEGIN CERTIFICATE-----
8a7c124b7191a79abed16bc14a22f99923b700fa:localhost-key.pem
1:-----BEGIN PRIVATE KEY-----
28:-----END PRIVATE KEY-----
8a7c124b7191a79abed16bc14a22f99923b700fa:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
8a7c124b7191a79abed16bc14a22f99923b700fa:README.md
7:1. Copy `.env.example` to `.env` and fill values (`MONGODB_URI`, `JWT_SECRET`).
54:- `JWT_SECRET` : secret JWT fort (NE JAMAIS LE COMMITER)
162:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
8a7c124b7191a79abed16bc14a22f99923b700fa:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
8a7c124b7191a79abed16bc14a22f99923b700fa:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
8a7c124b7191a79abed16bc14a22f99923b700fa:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
8a7c124b7191a79abed16bc14a22f99923b700fa:pages/api/auth/register.js
64:    const JWT_SECRET = process.env.JWT_SECRET
65:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
66:      console.error('JWT_SECRET not set in production')
69:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
8a7c124b7191a79abed16bc14a22f99923b700fa:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
8a7c124b7191a79abed16bc14a22f99923b700fa:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
8a7c124b7191a79abed16bc14a22f99923b700fa:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
8a7c124b7191a79abed16bc14a22f99923b700fa:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
8a7c124b7191a79abed16bc14a22f99923b700fa:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
8a7c124b7191a79abed16bc14a22f99923b700fa:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
38eb3783136be5d41e92ae92c9b41a6459c3022e:localhost-key.pem
1:-----BEGIN PRIVATE KEY-----
38eb3783136be5d41e92ae92c9b41a6459c3022e:localhost.pem
1:-----BEGIN CERTIFICATE-----
38eb3783136be5d41e92ae92c9b41a6459c3022e:localhost-key.pem
1:-----BEGIN PRIVATE KEY-----
28:-----END PRIVATE KEY-----
38eb3783136be5d41e92ae92c9b41a6459c3022e:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
38eb3783136be5d41e92ae92c9b41a6459c3022e:README.md
7:1. Copy `.env.example` to `.env` and fill values (`MONGODB_URI`, `JWT_SECRET`).
54:- `JWT_SECRET` : secret JWT fort (NE JAMAIS LE COMMITER)
162:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
38eb3783136be5d41e92ae92c9b41a6459c3022e:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
38eb3783136be5d41e92ae92c9b41a6459c3022e:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
38eb3783136be5d41e92ae92c9b41a6459c3022e:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
38eb3783136be5d41e92ae92c9b41a6459c3022e:pages/api/auth/register.js
64:    const JWT_SECRET = process.env.JWT_SECRET
65:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
66:      console.error('JWT_SECRET not set in production')
69:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
38eb3783136be5d41e92ae92c9b41a6459c3022e:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
38eb3783136be5d41e92ae92c9b41a6459c3022e:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
38eb3783136be5d41e92ae92c9b41a6459c3022e:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
38eb3783136be5d41e92ae92c9b41a6459c3022e:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
38eb3783136be5d41e92ae92c9b41a6459c3022e:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
38eb3783136be5d41e92ae92c9b41a6459c3022e:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
61fa44b06dcff798d660019582450fac665fc511:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
61fa44b06dcff798d660019582450fac665fc511:README.md
7:1. Copy `.env.example` to `.env` and fill values (`MONGODB_URI`, `JWT_SECRET`).
54:- `JWT_SECRET` : secret JWT fort (NE JAMAIS LE COMMITER)
162:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
61fa44b06dcff798d660019582450fac665fc511:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
61fa44b06dcff798d660019582450fac665fc511:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
61fa44b06dcff798d660019582450fac665fc511:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
61fa44b06dcff798d660019582450fac665fc511:pages/api/auth/register.js
64:    const JWT_SECRET = process.env.JWT_SECRET
65:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
66:      console.error('JWT_SECRET not set in production')
69:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
61fa44b06dcff798d660019582450fac665fc511:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
61fa44b06dcff798d660019582450fac665fc511:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
61fa44b06dcff798d660019582450fac665fc511:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
61fa44b06dcff798d660019582450fac665fc511:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
61fa44b06dcff798d660019582450fac665fc511:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
61fa44b06dcff798d660019582450fac665fc511:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
44b26324c24821d79cfdacdce7ae2fd083b1da2b:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
44b26324c24821d79cfdacdce7ae2fd083b1da2b:README.md
7:1. Copy `.env.example` to `.env` and fill values (`MONGODB_URI`, `JWT_SECRET`).
54:- `JWT_SECRET` : secret JWT fort (NE JAMAIS LE COMMITER)
162:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
44b26324c24821d79cfdacdce7ae2fd083b1da2b:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
44b26324c24821d79cfdacdce7ae2fd083b1da2b:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
44b26324c24821d79cfdacdce7ae2fd083b1da2b:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
44b26324c24821d79cfdacdce7ae2fd083b1da2b:pages/api/auth/register.js
64:    const JWT_SECRET = process.env.JWT_SECRET
65:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
66:      console.error('JWT_SECRET not set in production')
69:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
44b26324c24821d79cfdacdce7ae2fd083b1da2b:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
44b26324c24821d79cfdacdce7ae2fd083b1da2b:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
44b26324c24821d79cfdacdce7ae2fd083b1da2b:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
44b26324c24821d79cfdacdce7ae2fd083b1da2b:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
44b26324c24821d79cfdacdce7ae2fd083b1da2b:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
44b26324c24821d79cfdacdce7ae2fd083b1da2b:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
e75ea8989504574b2242c18889f03a07443d42d3:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
e75ea8989504574b2242c18889f03a07443d42d3:README.md
7:1. Copy `.env.example` to `.env` and fill values (`MONGODB_URI`, `JWT_SECRET`).
54:- `JWT_SECRET` : secret JWT fort (NE JAMAIS LE COMMITER)
162:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
e75ea8989504574b2242c18889f03a07443d42d3:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
e75ea8989504574b2242c18889f03a07443d42d3:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
e75ea8989504574b2242c18889f03a07443d42d3:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
e75ea8989504574b2242c18889f03a07443d42d3:pages/api/auth/register.js
64:    const JWT_SECRET = process.env.JWT_SECRET
65:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
66:      console.error('JWT_SECRET not set in production')
69:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
e75ea8989504574b2242c18889f03a07443d42d3:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
e75ea8989504574b2242c18889f03a07443d42d3:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
e75ea8989504574b2242c18889f03a07443d42d3:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
e75ea8989504574b2242c18889f03a07443d42d3:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
e75ea8989504574b2242c18889f03a07443d42d3:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
e75ea8989504574b2242c18889f03a07443d42d3:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
b4e39c7471be0840fc2c33b7cdda04a755b7ad4c:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
b4e39c7471be0840fc2c33b7cdda04a755b7ad4c:README.md
7:1. Copy `.env.example` to `.env` and fill values (`MONGODB_URI`, `JWT_SECRET`).
54:- `JWT_SECRET` : secret JWT fort (NE JAMAIS LE COMMITER)
162:- Si `npm run dev` ├®choue : v├®rifier `MONGODB_URI`, `JWT_SECRET` et que MongoDB est joignable.
b4e39c7471be0840fc2c33b7cdda04a755b7ad4c:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
b4e39c7471be0840fc2c33b7cdda04a755b7ad4c:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
b4e39c7471be0840fc2c33b7cdda04a755b7ad4c:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
b4e39c7471be0840fc2c33b7cdda04a755b7ad4c:pages/api/auth/register.js
64:    const JWT_SECRET = process.env.JWT_SECRET
65:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
66:      console.error('JWT_SECRET not set in production')
69:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
b4e39c7471be0840fc2c33b7cdda04a755b7ad4c:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
b4e39c7471be0840fc2c33b7cdda04a755b7ad4c:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
b4e39c7471be0840fc2c33b7cdda04a755b7ad4c:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
b4e39c7471be0840fc2c33b7cdda04a755b7ad4c:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
b4e39c7471be0840fc2c33b7cdda04a755b7ad4c:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
b4e39c7471be0840fc2c33b7cdda04a755b7ad4c:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
08b31761c60542f77218d98113f6a16f76b62d47:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
08b31761c60542f77218d98113f6a16f76b62d47:README.md
7:1. Copy `.env.example` to `.env` and fill values (`MONGODB_URI`, `JWT_SECRET`).
08b31761c60542f77218d98113f6a16f76b62d47:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
08b31761c60542f77218d98113f6a16f76b62d47:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
08b31761c60542f77218d98113f6a16f76b62d47:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
08b31761c60542f77218d98113f6a16f76b62d47:pages/api/auth/register.js
64:    const JWT_SECRET = process.env.JWT_SECRET
65:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
66:      console.error('JWT_SECRET not set in production')
69:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
08b31761c60542f77218d98113f6a16f76b62d47:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
08b31761c60542f77218d98113f6a16f76b62d47:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
08b31761c60542f77218d98113f6a16f76b62d47:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
08b31761c60542f77218d98113f6a16f76b62d47:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
08b31761c60542f77218d98113f6a16f76b62d47:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
08b31761c60542f77218d98113f6a16f76b62d47:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
9ffa7d7042287e06471f4282e23d707b96dc8190:.env.example
2:JWT_SECRET=
9ffa7d7042287e06471f4282e23d707b96dc8190:README.md
7:1. Copy `.env.example` to `.env` and fill values (`MONGODB_URI`, `JWT_SECRET`).
9ffa7d7042287e06471f4282e23d707b96dc8190:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
9ffa7d7042287e06471f4282e23d707b96dc8190:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
9ffa7d7042287e06471f4282e23d707b96dc8190:pages/api/auth/login.js
21:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, process.env.JWT_SECRET || 'devsecret', { expiresIn: '30m' })
9ffa7d7042287e06471f4282e23d707b96dc8190:pages/api/auth/register.js
39:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, process.env.JWT_SECRET || 'devsecret', { expiresIn: '30m' })
9ffa7d7042287e06471f4282e23d707b96dc8190:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
9ffa7d7042287e06471f4282e23d707b96dc8190:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
9ffa7d7042287e06471f4282e23d707b96dc8190:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
9ffa7d7042287e06471f4282e23d707b96dc8190:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
bfea227bae5a2ba6b923da3d067595a9b3004b99:.env.example
6:JWT_SECRET=change-me-to-a-strong-secret
bfea227bae5a2ba6b923da3d067595a9b3004b99:README.md
7:1. Copy `.env.example` to `.env` and fill values (`MONGODB_URI`, `JWT_SECRET`).
bfea227bae5a2ba6b923da3d067595a9b3004b99:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
bfea227bae5a2ba6b923da3d067595a9b3004b99:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
bfea227bae5a2ba6b923da3d067595a9b3004b99:pages/api/auth/login.js
75:    const JWT_SECRET = process.env.JWT_SECRET
76:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
77:      console.error('JWT_SECRET not set in production')
81:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
bfea227bae5a2ba6b923da3d067595a9b3004b99:pages/api/auth/register.js
64:    const JWT_SECRET = process.env.JWT_SECRET
65:    if (!JWT_SECRET && process.env.NODE_ENV === 'production') {
66:      console.error('JWT_SECRET not set in production')
69:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, JWT_SECRET || 'devsecret', { expiresIn: '15m' })
bfea227bae5a2ba6b923da3d067595a9b3004b99:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
bfea227bae5a2ba6b923da3d067595a9b3004b99:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
bfea227bae5a2ba6b923da3d067595a9b3004b99:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
bfea227bae5a2ba6b923da3d067595a9b3004b99:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
bfea227bae5a2ba6b923da3d067595a9b3004b99:.env.example
39:EXTERNAL_API_KEY=change-me-to-your-api-key
45:#   `EXTERNAL_API_KEY` values above.
bfea227bae5a2ba6b923da3d067595a9b3004b99:Checklist-Audit-Securite.md
21:- V├®rifier : `grep -r "password\|api_key\|token" src/` (doit ├¬tre vide)
2f1f6b3bc73bb4dd8db3498c571fbf7210386804:.env.example
2:JWT_SECRET=
2f1f6b3bc73bb4dd8db3498c571fbf7210386804:README.md
7:1. Copy `.env.example` to `.env` and fill values (`MONGODB_URI`, `JWT_SECRET`).
2f1f6b3bc73bb4dd8db3498c571fbf7210386804:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
2f1f6b3bc73bb4dd8db3498c571fbf7210386804:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
2f1f6b3bc73bb4dd8db3498c571fbf7210386804:pages/api/auth/login.js
21:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, process.env.JWT_SECRET || 'devsecret', { expiresIn: '30m' })
2f1f6b3bc73bb4dd8db3498c571fbf7210386804:pages/api/auth/register.js
39:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, process.env.JWT_SECRET || 'devsecret', { expiresIn: '30m' })
2f1f6b3bc73bb4dd8db3498c571fbf7210386804:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
2f1f6b3bc73bb4dd8db3498c571fbf7210386804:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
2f1f6b3bc73bb4dd8db3498c571fbf7210386804:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
2f1f6b3bc73bb4dd8db3498c571fbf7210386804:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
3663af21598eb204da4f05661eef87f8db5b10cb:.env.example
2:JWT_SECRET=
3663af21598eb204da4f05661eef87f8db5b10cb:README.md
7:1. Copy `.env.example` to `.env` and fill values (`MONGODB_URI`, `JWT_SECRET`).
3663af21598eb204da4f05661eef87f8db5b10cb:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
3663af21598eb204da4f05661eef87f8db5b10cb:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
3663af21598eb204da4f05661eef87f8db5b10cb:pages/api/auth/login.js
21:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, process.env.JWT_SECRET || 'devsecret', { expiresIn: '30m' })
3663af21598eb204da4f05661eef87f8db5b10cb:pages/api/auth/register.js
39:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, process.env.JWT_SECRET || 'devsecret', { expiresIn: '30m' })
3663af21598eb204da4f05661eef87f8db5b10cb:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
3663af21598eb204da4f05661eef87f8db5b10cb:pages/api/todolists/index.js
14:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
3663af21598eb204da4f05661eef87f8db5b10cb:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
3663af21598eb204da4f05661eef87f8db5b10cb:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
81e43211ef237781936a805b08c182c71a73062f:.env.example
2:JWT_SECRET=
81e43211ef237781936a805b08c182c71a73062f:README.md
7:1. Copy `.env.example` to `.env` and fill values (`MONGODB_URI`, `JWT_SECRET`).
81e43211ef237781936a805b08c182c71a73062f:lib/auth.js
14:  - use `process.env.JWT_SECRET` in production and rotate secrets appropriately
21:const JWT_SECRET = process.env.JWT_SECRET || 'devsecret'
35:    const payload = jwt.verify(token, JWT_SECRET)
59:    const payload = jwt.verify(token, JWT_SECRET)
81e43211ef237781936a805b08c182c71a73062f:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
81e43211ef237781936a805b08c182c71a73062f:pages/api/auth/login.js
21:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, process.env.JWT_SECRET || 'devsecret', { expiresIn: '30m' })
81e43211ef237781936a805b08c182c71a73062f:pages/api/auth/register.js
39:    const token = jwt.sign({ id: user._id, role: user.role, tokenVersion: user.tokenVersion }, process.env.JWT_SECRET || 'devsecret', { expiresIn: '30m' })
81e43211ef237781936a805b08c182c71a73062f:pages/api/todolists/[id].js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
81e43211ef237781936a805b08c182c71a73062f:pages/api/todolists/index.js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
81e43211ef237781936a805b08c182c71a73062f:pages/api/todos/index.js
12:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
81e43211ef237781936a805b08c182c71a73062f:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
5a8a092712160f6e4a2c166bc9bd18f46ef482ee:.env.example
2:JWT_SECRET=
5a8a092712160f6e4a2c166bc9bd18f46ef482ee:README.md
7:1. Copy `.env.example` to `.env` and fill values (`MONGODB_URI`, `JWT_SECRET`).
5a8a092712160f6e4a2c166bc9bd18f46ef482ee:pages/api/admin/dashboard.js
18:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
5a8a092712160f6e4a2c166bc9bd18f46ef482ee:pages/api/auth/login.js
21:    const token = jwt.sign({ id: user._id, role: user.role }, process.env.JWT_SECRET || 'devsecret', { expiresIn: '30m' })
5a8a092712160f6e4a2c166bc9bd18f46ef482ee:pages/api/auth/register.js
39:    const token = jwt.sign({ id: user._id, role: user.role }, process.env.JWT_SECRET || 'devsecret', { expiresIn: '30m' })
5a8a092712160f6e4a2c166bc9bd18f46ef482ee:pages/api/todos/[id]/assign.js
11:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
51:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
96:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
5a8a092712160f6e4a2c166bc9bd18f46ef482ee:pages/api/todos/index.js
13:    const payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret')
54:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
93:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
5a8a092712160f6e4a2c166bc9bd18f46ef482ee:pages/api/users/me.js
19:  try { payload = jwt.verify(token, process.env.JWT_SECRET || 'devsecret') } catch (e) { return res.status(401).json({ message: 'Unauthorized' }) }
